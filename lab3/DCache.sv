// Generated by CIRCT firtool-1.62.0
// external module blk_mem_gen_1

module DCache(
  input          clock,
                 reset,
  input  [3:0]   io_data_ren,
  input  [31:0]  io_data_addr,
  output         io_data_valid,
  output [31:0]  io_data_rdata,
  input  [3:0]   io_data_wen,
  input  [31:0]  io_data_wdata,
  output         io_data_wresp,
  input          io_dev_wrdy,
  output [3:0]   io_dev_wen,
  output [31:0]  io_dev_waddr,
                 io_dev_wdata,
  input          io_dev_rrdy,
  output [3:0]   io_dev_ren,
  output [31:0]  io_dev_raddr,
  input          io_dev_rvalid,
  input  [127:0] io_dev_rdata
);

  wire [127:0]     _U_dsram_douta;
  wire [127:0]     _tagSram_douta;
  reg              wr_resp_REG;
  wire             wr_resp = ~wr_resp_REG & io_dev_wrdy;
  wire             uncached =
    (&(io_data_addr[31:16])) & ((|io_data_ren) | (|io_data_wen));
  wire [5:0]       _GEN = {1'h0, io_data_addr[8:4]};
  reg  [3:0]       r_state;
  reg  [3:0]       ren_r;
  reg  [1:0]       r_cnt_value;
  wire             _GEN_0 = r_state == 4'h0;
  wire             _GEN_1 = r_state == 4'h1;
  wire             _GEN_2 = r_state == 4'h2;
  wire             _GEN_3 = r_state == 4'h3;
  wire             _GEN_4 =
    _tagSram_douta[22:0] == io_data_addr[31:9] & _tagSram_douta[23];
  wire             hit_r = ~(_GEN_0 | _GEN_1 | _GEN_2) & _GEN_3 & _GEN_4;
  wire [3:0][31:0] _GEN_5 =
    {{_U_dsram_douta[127:96]},
     {_U_dsram_douta[95:64]},
     {_U_dsram_douta[63:32]},
     {_U_dsram_douta[31:0]}};
  wire             _GEN_6 = r_state == 4'h4;
  wire             _GEN_7 = r_state == 4'h5;
  wire [3:0][31:0] _GEN_8 =
    {{io_dev_rdata[127:96]},
     {io_dev_rdata[95:64]},
     {io_dev_rdata[63:32]},
     {io_dev_rdata[31:0]}};
  wire             _GEN_9 = r_state == 4'h6;
  reg  [1:0]       REG;
  wire             _GEN_10 = (&REG) & r_cnt_value == 2'h0;
  wire [3:0]       _GEN_11 = {4{io_dev_wrdy}};
  wire             _GEN_12 = _GEN_0 | _GEN_1 | _GEN_2 | _GEN_3 | _GEN_6 | _GEN_7;
  wire             _GEN_13 = _GEN_12 | ~_GEN_9 | _GEN_10;
  wire             _GEN_14 = _GEN_12 | ~_GEN_9 | _GEN_10 | ~io_dev_wrdy;
  wire [31:0]      _GEN_15 = _GEN_14 ? 32'h0 : {io_data_addr[31:4], r_cnt_value, 2'h0};
  wire [3:0][31:0] _GEN_16 =
    {{_U_dsram_douta[127:96]},
     {_U_dsram_douta[95:64]},
     {_U_dsram_douta[63:32]},
     {_U_dsram_douta[31:0]}};
  wire [31:0]      _GEN_17 = _GEN_14 ? 32'h0 : _GEN_16[r_cnt_value];
  wire             _GEN_18 = r_state == 4'h7;
  wire             _GEN_19 = r_state == 4'h8;
  wire             _GEN_20 = _GEN_19 & io_dev_rrdy;
  wire [3:0]       _GEN_21 = {4{_GEN_20}};
  wire             _GEN_22 = _GEN_7 | _GEN_9 | _GEN_18;
  wire             _GEN_23 = _GEN_2 | _GEN_3;
  wire [3:0]       _GEN_24 =
    _GEN_0
      ? 4'h0
      : _GEN_1
          ? (io_dev_rrdy ? ren_r : 4'h0)
          : _GEN_23 ? 4'h0 : _GEN_6 ? {4{io_dev_rrdy}} : _GEN_22 ? 4'h0 : _GEN_21;
  wire             _GEN_25 = _GEN_0 | _GEN_1;
  wire             _GEN_26 = _GEN_25 | _GEN_23 | _GEN_6 | _GEN_22;
  wire [31:0]      _io_dev_raddr_T_1 = {io_data_addr[31:4], 4'h0};
  wire [31:0]      _GEN_27 =
    _GEN_0
      ? 32'h0
      : _GEN_1
          ? (io_dev_rrdy ? io_data_addr : 32'h0)
          : _GEN_23
              ? 32'h0
              : _GEN_6
                  ? (io_dev_rrdy ? {io_data_addr[31:4], 4'h0} : 32'h0)
                  : _GEN_22 | ~_GEN_20 ? 32'h0 : _io_dev_raddr_T_1;
  wire [31:0]      _GEN_28 = _GEN_26 | ~_GEN_20 ? 32'h0 : _io_dev_raddr_T_1;
  wire             _GEN_29 = r_state == 4'h9;
  wire             _GEN_30 = _GEN_9 | _GEN_18 | _GEN_19;
  wire             _GEN_31 = (_GEN_7 | ~_GEN_30 & _GEN_29) & io_dev_rvalid;
  wire             _GEN_32 = _GEN_0 | _GEN_1 | _GEN_2 | _GEN_3 | _GEN_6;
  wire             _GEN_33 = ~_GEN_32 & _GEN_31;
  wire [127:0]     _GEN_34 = {105'h3, io_data_addr[31:9]};
  wire             _GEN_35 = _GEN_29 & io_dev_rvalid;
  wire             _GEN_36 = _GEN_30 | ~_GEN_35;
  wire [127:0]     _GEN_37 =
    _GEN_32
      ? 128'h0
      : _GEN_7
          ? (io_dev_rvalid ? {105'h1, io_data_addr[31:9]} : 128'h0)
          : _GEN_36 ? 128'h0 : _GEN_34;
  wire             _GEN_38 = _GEN_32 | _GEN_7 | _GEN_30 | ~_GEN_35;
  wire [127:0]     _GEN_39 =
    _GEN_32
      ? 128'h0
      : _GEN_7
          ? (io_dev_rvalid ? io_dev_rdata : 128'h0)
          : _GEN_36 ? 128'h0 : io_dev_rdata;
  wire [127:0]     _GEN_40 = _GEN_38 ? 128'h0 : io_dev_rdata;
  reg  [3:0]       w_state;
  reg  [3:0]       wen_r;
  reg  [31:0]      wdata;
  reg  [1:0]       w_cnt_value;
  wire             _GEN_41 = w_state == 4'h0;
  wire             _GEN_42 = w_state == 4'h1;
  wire             _GEN_43 = w_state == 4'h2;
  wire             _GEN_44 = w_state == 4'h3;
  wire             _GEN_45 = io_data_addr[3:2] == 2'h0;
  wire             _GEN_46 = io_data_addr[3:2] == 2'h1;
  wire             _GEN_47 = io_data_addr[3:2] == 2'h2;
  wire             _GEN_48 = _GEN_41 | _GEN_42 | _GEN_43;
  wire             hit_w = ~_GEN_48 & _GEN_44 & _GEN_4;
  wire             _GEN_49 = w_state == 4'h4;
  wire [3:0]       _GEN_50 = io_dev_rrdy ? 4'hF : _GEN_26 ? 4'h0 : _GEN_21;
  wire             _GEN_51 = w_state == 4'h5;
  wire             _GEN_52 = w_state == 4'h6;
  reg  [1:0]       REG_1;
  wire             _GEN_53 = (&REG_1) & w_cnt_value == 2'h0;
  wire             _GEN_54 = _GEN_43 | _GEN_44 | _GEN_49 | _GEN_51;
  wire             _GEN_55 = _GEN_54 | ~_GEN_52 | _GEN_53;
  wire [3:0][31:0] _GEN_56 =
    {{_U_dsram_douta[127:96]},
     {_U_dsram_douta[95:64]},
     {_U_dsram_douta[63:32]},
     {_U_dsram_douta[31:0]}};
  wire             _GEN_57 = w_state == 4'h7;
  wire             _GEN_58 = w_state == 4'h8;
  wire             _GEN_59 = _GEN_52 | _GEN_57;
  wire             _GEN_60 = _GEN_41 | _GEN_42 | _GEN_43 | _GEN_44;
  wire             _GEN_61 = w_state == 4'h9;
  wire             _GEN_62 = _GEN_61 & io_dev_rvalid;
  wire             _GEN_63 = _GEN_52 | _GEN_57 | _GEN_58;
  wire             _GEN_64 =
    _GEN_48
      ? _GEN_33
      : _GEN_44
          ? _GEN_4 | _GEN_33
          : _GEN_49
              ? _GEN_33
              : _GEN_51 ? io_dev_rvalid | _GEN_33 : ~_GEN_63 & _GEN_62 | _GEN_33;
  wire             _GEN_65 = _GEN_63 | ~_GEN_61;
  always @(posedge clock) begin
    wr_resp_REG <= io_dev_wrdy;
    REG <= r_cnt_value;
    REG_1 <= w_cnt_value;
    if (reset) begin
      r_state <= 4'h0;
      ren_r <= 4'h0;
      r_cnt_value <= 2'h0;
      w_state <= 4'h0;
      wen_r <= 4'h0;
      wdata <= 32'h0;
      w_cnt_value <= 2'h0;
    end
    else begin
      automatic logic [3:0] _GEN_66;
      automatic logic [3:0] _GEN_67;
      _GEN_66 = {2'h0, ~(uncached | (|(io_data_addr[1:0]))), 1'h1};
      _GEN_67 = _GEN_4 ? 4'h0 : {2'h1, _tagSram_douta[24] & _tagSram_douta[23], 1'h0};
      if (_GEN_0) begin
        if (|io_data_ren)
          r_state <= _GEN_66;
      end
      else if (_GEN_1) begin
        if (io_dev_rrdy)
          r_state <= 4'h2;
      end
      else if (_GEN_2) begin
        if (io_dev_rvalid)
          r_state <= 4'h0;
      end
      else if (_GEN_3)
        r_state <= _GEN_67;
      else if (_GEN_6) begin
        if (io_dev_rrdy)
          r_state <= 4'h5;
      end
      else if (_GEN_7) begin
        if (io_dev_rvalid)
          r_state <= 4'h0;
      end
      else if (_GEN_9) begin
        if (_GEN_10)
          r_state <= 4'h8;
        else if (io_dev_wrdy)
          r_state <= 4'h7;
      end
      else if (_GEN_18) begin
        if (wr_resp)
          r_state <= 4'h6;
      end
      else if (_GEN_19) begin
        if (io_dev_rrdy)
          r_state <= 4'h9;
      end
      else if (_GEN_35)
        r_state <= 4'h0;
      if (_GEN_0 & (|io_data_ren))
        ren_r <= io_data_ren;
      if (_GEN_14) begin
      end
      else
        r_cnt_value <= r_cnt_value + 2'h1;
      if (_GEN_41) begin
        if (|io_data_wen)
          w_state <= _GEN_66;
      end
      else if (_GEN_42) begin
        if (io_dev_wrdy)
          w_state <= 4'h2;
      end
      else if (_GEN_43) begin
        if (wr_resp)
          w_state <= 4'h0;
      end
      else if (_GEN_44)
        w_state <= _GEN_67;
      else if (_GEN_49) begin
        if (io_dev_rrdy)
          w_state <= 4'h5;
      end
      else if (_GEN_51) begin
        if (io_dev_rvalid)
          w_state <= 4'h0;
      end
      else if (_GEN_52) begin
        if (_GEN_53)
          w_state <= 4'h8;
        else if (io_dev_wrdy)
          w_state <= 4'h7;
      end
      else if (_GEN_57) begin
        if (wr_resp)
          w_state <= 4'h6;
      end
      else if (_GEN_58) begin
        if (io_dev_rrdy)
          w_state <= 4'h9;
      end
      else if (_GEN_62)
        w_state <= 4'h0;
      if (_GEN_41 & (|io_data_wen)) begin
        wen_r <= io_data_wen;
        wdata <= io_data_wdata;
      end
      if (_GEN_41 | _GEN_42 | _GEN_54 | ~_GEN_52 | _GEN_53 | ~io_dev_wrdy) begin
      end
      else
        w_cnt_value <= w_cnt_value + 2'h1;
    end
  end // always @(posedge)
  blk_mem_gen_1 tagSram (
    .clka  (clock),
    .wea   (_GEN_64),
    .addra (_GEN),
    .dina
      (_GEN_48
         ? _GEN_37
         : _GEN_44
             ? (_GEN_4 ? _GEN_34 : _GEN_37)
             : _GEN_49 | ~(_GEN_51 | ~_GEN_65)
                 ? _GEN_37
                 : io_dev_rvalid | ~_GEN_38 ? _GEN_34 : 128'h0),
    .douta (_tagSram_douta)
  );
  blk_mem_gen_1 U_dsram (
    .clka  (clock),
    .wea   (_GEN_64),
    .addra (_GEN),
    .dina
      (_GEN_48
         ? _GEN_39
         : _GEN_44
             ? (_GEN_4
                  ? {(&(io_data_addr[3:2])) ? wdata : _U_dsram_douta[127:96],
                     _GEN_47 ? wdata : _U_dsram_douta[95:64],
                     _GEN_46 ? wdata : _U_dsram_douta[63:32],
                     _GEN_45 ? wdata : _U_dsram_douta[31:0]}
                  : _GEN_39)
             : _GEN_49
                 ? _GEN_39
                 : _GEN_51
                     ? (io_dev_rvalid
                          ? {(&(io_data_addr[3:2])) ? wdata : io_dev_rdata[127:96],
                             _GEN_47 ? wdata : io_dev_rdata[95:64],
                             _GEN_46 ? wdata : io_dev_rdata[63:32],
                             _GEN_45 ? wdata : io_dev_rdata[31:0]}
                          : _GEN_40)
                     : _GEN_65
                         ? _GEN_39
                         : io_dev_rvalid
                             ? {(&(io_data_addr[3:2])) ? wdata : io_dev_rdata[127:96],
                                _GEN_47 ? wdata : io_dev_rdata[95:64],
                                _GEN_46 ? wdata : io_dev_rdata[63:32],
                                _GEN_45 ? wdata : io_dev_rdata[31:0]}
                             : _GEN_40),
    .douta (_U_dsram_douta)
  );
  assign io_data_valid =
    ~_GEN_25 & (_GEN_2 ? io_dev_rvalid : _GEN_3 ? _GEN_4 : ~_GEN_6 & _GEN_31);
  assign io_data_rdata =
    _GEN_25
      ? 32'h0
      : _GEN_2
          ? (io_dev_rvalid ? io_dev_rdata[31:0] : 32'h0)
          : _GEN_3
              ? (_GEN_4 ? _GEN_5[io_data_addr[3:2]] : 32'h0)
              : _GEN_6
                  ? 32'h0
                  : _GEN_7
                      ? (io_dev_rvalid ? _GEN_8[io_data_addr[3:2]] : 32'h0)
                      : _GEN_36 ? 32'h0 : io_dev_rdata[31:0];
  assign io_data_wresp =
    ~(_GEN_41 | _GEN_42)
    & (_GEN_43
         ? wr_resp
         : _GEN_44 ? _GEN_4 : ~_GEN_49 & (_GEN_51 | ~_GEN_63 & _GEN_61) & io_dev_rvalid);
  assign io_dev_wen =
    _GEN_41
      ? (_GEN_13 ? 4'h0 : _GEN_11)
      : _GEN_42 ? (io_dev_wrdy ? wen_r : 4'h0) : _GEN_55 & _GEN_13 ? 4'h0 : _GEN_11;
  assign io_dev_waddr =
    _GEN_41
      ? _GEN_15
      : _GEN_42
          ? (io_dev_wrdy ? io_data_addr : 32'h0)
          : _GEN_55
              ? _GEN_15
              : io_dev_wrdy ? {io_data_addr[31:4], w_cnt_value, 2'h0} : 32'h0;
  assign io_dev_wdata =
    _GEN_41
      ? _GEN_17
      : _GEN_42
          ? (io_dev_wrdy ? wdata : 32'h0)
          : _GEN_55 ? _GEN_17 : io_dev_wrdy ? _GEN_56[w_cnt_value] : 32'h0;
  assign io_dev_ren =
    _GEN_60
      ? _GEN_24
      : _GEN_49 ? _GEN_50 : _GEN_51 ? 4'h0 : _GEN_59 | ~_GEN_58 ? _GEN_24 : _GEN_50;
  assign io_dev_raddr =
    _GEN_60
      ? _GEN_27
      : _GEN_49
          ? (io_dev_rrdy ? io_data_addr : _GEN_28)
          : _GEN_51 | _GEN_59 | ~_GEN_58
              ? _GEN_27
              : io_dev_rrdy ? {io_data_addr[31:4], 4'h0} : _GEN_28;
endmodule

